<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TaxiApp з Google Maps</title>
  <style>
    html, body {
      height: 100%;
      margin: 0; padding: 0;
      font-family: Arial, sans-serif;
      display: flex; flex-direction: column;
    }
    #map {
      flex-grow: 1;
    }
    header {
      display: flex; justify-content: space-between; align-items: center;
      padding: 10px 15px;
      background: #222;
      color: white;
    }
    .address-bar {
      position: absolute;
      top: 60px; left: 15px; right: 15px;
      background: rgba(255,255,255,0.9);
      border-radius: 8px;
      padding: 10px 15px;
      display: flex; justify-content: space-between; align-items: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.15);
      font-weight: bold;
      z-index: 10;
    }
    .car-type {
      display: flex; justify-content: center; margin: 10px 0;
    }
    .car-type button {
      background: #eee; border: none; margin: 0 10px;
      padding: 10px 20px; border-radius: 30px;
      font-weight: bold; cursor: pointer;
      transition: background 0.3s ease;
    }
    .car-type button.active {
      background: linear-gradient(135deg, #fc466b, #3f5efb);
      color: white;
    }
    .order-btn {
      margin: 15px auto 15px auto;
      padding: 15px 60px;
      background: linear-gradient(135deg, #fc466b, #3f5efb);
      border: none; border-radius: 35px;
      color: white; font-size: 1.2em;
      cursor: pointer;
      box-shadow: 0 6px 10px rgba(252,70,107,0.7);
      transition: box-shadow 0.3s ease;
      display: block;
      z-index: 10;
      position: relative;
    }
    .order-btn:hover {
      box-shadow: 0 8px 15px rgba(252,70,107,1);
    }
    footer {
      display: flex; justify-content: space-around;
      background: #222; padding: 10px 0;
    }
    footer button {
      background: none; border: none; color: white;
      font-weight: bold; font-size: 1em;
      cursor: pointer;
    }
  </style>
</head>
<body>
<header>
  <div>☰</div>
  <div>TaxiApp</div>
  <div></div>
</header>

<div id="map"></div>

<div class="address-bar">
  <div id="address">Визначення адреси...</div>
  <button onclick="editAddress()">✎ Змінити</button>
</div>

<div class="car-type">
  <button class="active" onclick="selectCarType(this)">Економ</button>
  <button onclick="selectCarType(this)">Бізнес</button>
</div>

<button class="order-btn" onclick="orderTaxi()">Замовити таксі</button>

<footer>
  <button>Історія</button>
  <button>Профіль</button>
  <button>Підтримка</button>
</footer>

<script>
  let map, marker, geocoder;
  let watchId;
  let currentPosition;

  function initMap() {
    geocoder = new google.maps.Geocoder();

    // Ініціалізуємо карту з центром у Києві (поки немає позиції)
    map = new google.maps.Map(document.getElementById("map"), {
      center: { lat: 50.4501, lng: 30.5234 },
      zoom: 15,
      disableDefaultUI: true,
      zoomControl: true,
    });

    // Запитуємо позицію і слідкуємо в реальному часі
    if (navigator.geolocation) {
      watchId = navigator.geolocation.watchPosition(
        (pos) => {
          currentPosition = {
            lat: pos.coords.latitude,
            lng: pos.coords.longitude,
          };

          updateMapAndMarker(currentPosition);
          updateAddress(currentPosition);
        },
        (error) => {
          alert("Помилка отримання геолокації: " + error.message);
        },
        { enableHighAccuracy: true, maximumAge: 0 }
      );
    } else {
      alert("Геолокація не підтримується вашим браузером.");
    }
  }

  function updateMapAndMarker(pos) {
    map.setCenter(pos);
    if (!marker) {
      marker = new google.maps.Marker({
        position: pos,
        map: map,
        title: "Ваше місце",
        icon: {
          path: google.maps.SymbolPath.CIRCLE,
          scale: 8,
          fillColor: "#3f5efb",
          fillOpacity: 0.9,
          strokeWeight: 2,
          strokeColor: "white",
        },
      });
    } else {
      marker.setPosition(pos);
    }
  }

  function updateAddress(pos) {
    geocoder.geocode({ location: pos }, (results, status) => {
      if (status === "OK") {
        if (results[0]) {
          document.getElementById("address").textContent = results[0].formatted_address;
        } else {
          document.getElementById("address").textContent = "Адресу не знайдено";
        }
      } else {
        document.getElementById("address").textContent = "Помилка геокодування";
      }
    });
  }

  function selectCarType(button) {
    document.querySelectorAll(".car-type button").forEach((btn) => btn.classList.remove("active"));
    button.classList.add("active");
  }

  function orderTaxi() {
    alert("Таксі замовлено на адресу:\n" + document.getElementById("address").textContent +
      "\nТип авто: " + document.querySelector(".car-type .active").textContent);
  }

  function editAddress() {
    let newAddress = prompt("Введіть адресу:", document.getElementById("address").textContent);
    if (newAddress) {
      document.getElementById("address").textContent = newAddress;
      // Тут можна додати геокодування введеної адреси, щоб оновити карту
      geocoder.geocode({ address: newAddress }, (results, status) => {
        if (status === "OK" && results[0]) {
          map.setCenter(results[0].geometry.location);
          marker.setPosition(results[0].geometry.location);
        } else {
          alert("Адресу не знайдено");
        }
      });
    }
  }
</script>

<script async
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDH0JFSFD5fpH1dK5d9p-fU1IxvWOw9loQ&callback=initMap">
</script>
</body>
</html>
